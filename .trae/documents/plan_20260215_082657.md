# 个人宏观经济指标分析网站 - 架构设计方案

## 一、技术选型（轻量级本地部署）

### 后端技术栈
- **语言框架**: Python 3.10+ + FastAPI
- **数据获取**: akshare（轻量级A股/宏观经济数据库）
- **关系数据库**: SQLite（轻量级，无需额外安装）
- **时序数据**: 直接使用SQLite + Pandas处理
- **缓存**: Redis（可选，后期按需添加）

### 前端技术栈
- **框架**: Vue 3 + TypeScript + Vite
- **UI组件**: Element Plus
- **可视化**: ECharts
- **状态管理**: Pinia

### 部署方式
- **本地开发**: Docker Compose 一键启动
- **个人电脑**: 支持 macOS/Windows + Docker Desktop

---

## 二、系统架构设计

### 整体架构图
```
┌─────────────────────────────────────────────────────────────┐
│                      前端展示层 (Vue3)                       │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌──────────────────┐   │
│  │ 仪表盘  │ │ 指标分析│ │ 预警中心│ │ 投资决策辅助    │   │
│  └────┬────┘ └────┬────┘ └────┬────┘ └────────┬─────────┘   │
└───────┼──────────┼──────────┼───────────────┼──────────────┘
        │          │          │               │
        └──────────┴────┬─────┴───────────────┘
                        │ HTTP/RESTful API
┌───────────────────────┼──────────────────────────────────────┐
│                  应用服务层 (FastAPI)                         │
│  ┌──────────────┐ ┌──────────────┐ ┌────────────────────┐   │
│  │ 用户服务     │ │ 指标计算服务 │ │ 数据采集服务       │   │
│  │ - 认证/权限  │ │ - 指标计算   │ │ - akshare接入     │   │
│  │ - 会话管理   │ │ - 趋势分析   │ │ - 数据清洗/标准化 │   │
│  └──────────────┘ └──────────────┘ └────────────────────┘   │
└───────────────────────┬──────────────────────────────────────┘
                        │
┌───────────────────────┼──────────────────────────────────────┐
│                      数据层                                   │
│  ┌──────────────┐ ┌──────────────┐ ┌────────────────────┐   │
│  │ SQLite       │ │ 文件缓存     │ │ 数据模型           │   │
│  │ - 用户数据   │ │ - JSON/CSV  │ │ - 统一数据格式     │   │
│  │ - 指标元数据 │ │ - 定时刷新   │ │ - 指标定义规范    │   │
│  └──────────────┘ └──────────────┘ └────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

---

## 三、模块详细设计

### 1. 数据层架构

#### 1.1 数据接入模块
```python
# 数据源支持
- akshare: A股行情、宏观经济数据（GDP、CPI、PPI、PMI等）
- 扩展接口: 预留央行/统计局API接入能力
```

#### 1.2 数据清洗流程
```
原始数据 → 缺失值处理 → 异常值检测 → 单位统一 → 标准化存储
```

#### 1.3 缓存策略
- **内存缓存**: Python dict/Cache 存储热点数据
- **文件缓存**: JSON/CSV 文件存储历史数据
- **更新策略**: 
  - 实时数据: 每次请求时更新
  - 宏观经济指标: 每日定时更新

---

### 2. 应用服务层设计

#### 2.1 微服务模块划分
| 服务 | 职责 | API端点 |
|------|------|---------|
| 用户服务 | 登录/注册/权限 | `/api/auth/*` |
| 数据采集服务 | 数据获取/清洗 | `/api/data/*` |
| 指标计算服务 | 指标计算/分析 | `/api/indicators/*` |
| 预警服务 | 阈值监控/通知 | `/api/alerts/*` |

#### 2.2 指标扩展机制
```python
# 指标注册示例
class Indicator:
    name: str           # 指标名称
    code: str           # 数据源代码
    update_freq: str    # 更新频率
    calculate_fn: Optional[Callable]  # 计算函数
    
# 扩展新指标只需注册即可
```

---

### 3. 前端展示层方案

#### 3.1 页面结构
```
src/
├── views/
│   ├── Dashboard.vue      # 仪表盘首页
│   ├── Indicators.vue    # 经济指标列表
│   ├── Analysis.vue       # 多维分析
│   ├── Alerts.vue         # 预警中心
│   └── Decision.vue       # 投资决策辅助
├── components/
│   ├── charts/           # 图表组件
│   │   ├── LineChart.vue
│   │   ├── BarChart.vue
│   │   └── HeatMap.vue
│   └── common/           # 通用组件
└── stores/               # Pinia状态管理
```

#### 3.2 核心功能
- **仪表盘**: 关键指标实时展示 + 图表可视化
- **指标分析**: 时间序列对比、多指标相关性
- **预警系统**: 自定义阈值 + 推送通知
- **投资辅助**: 趋势预测 + 情景模拟

---

## 四、数据流程

```
┌────────────┐     ┌─────────────┐     ┌──────────────┐
│  akshare   │────▶│ 数据采集服务│────▶│  数据清洗    │
│  数据源    │     │             │     │              │
└────────────┘     └──────┬──────┘     └──────┬───────┘
                         │                    │
                         ▼                    ▼
                  ┌─────────────┐     ┌──────────────┐
                  │  缓存层     │◀───▶│  SQLite存储  │
                  │  (内存/文件)│     │              │
                  └──────┬──────┘     └──────────────┘
                         │
                         ▼
                  ┌─────────────┐     ┌──────────────┐
                  │ API网关      │────▶│  前端展示    │
                  │ (FastAPI)    │     │  (Vue3)      │
                  └─────────────┘     └──────────────┘
```

---

## 五、接口设计

### 核心API列表
| 方法 | 路径 | 描述 |
|------|------|------|
| POST | `/api/auth/login` | 用户登录 |
| GET | `/api/indicators` | 获取指标列表 |
| GET | `/api/indicators/{id}/data` | 获取指标数据 |
| GET | `/api/indicators/compare` | 指标对比分析 |
| GET | `/api/indicators/trend` | 趋势分析 |
| POST | `/api/alerts` | 创建预警规则 |
| GET | `/api/alerts` | 获取预警列表 |

---

## 六、部署策略（个人电脑）

### 开发环境
```bash
# 方式1: 直接运行（推荐）
cd backend && pip install -r requirements.txt && uvicorn main:app --reload
cd frontend && npm install && npm run dev

# 方式2: Docker Compose
docker-compose up -d
```

### Docker Compose 配置
```yaml
version: '3.8'
services:
  backend:
    build: ./backend
    ports:
      - "8000:8000"
    volumes:
      - ./data:/app/data
  
  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    depends_on:
      - backend
```

---

## 七、扩展性设计

### 后续可扩展方向
1. **数据源扩展**: 接入央行、统计局、IMF等官方API
2. **数据库升级**: SQLite → PostgreSQL + InfluxDB
3. **部署升级**: Docker Compose → Kubernetes（阿里云）
4. **功能增强**: 增加机器学习预测模型

---

## 八、实施计划

### Phase 1: 基础框架搭建
- [ ] 项目初始化（前后端脚手架）
- [ ] 后端FastAPI框架搭建
- [ ] 前端Vue3 + ECharts集成

### Phase 2: 核心功能实现
- [ ] akshare数据接入
- [ ] 指标数据展示
- [ ] 基础图表可视化

### Phase 3: 高级功能
- [ ] 用户认证系统
- [ ] 预警功能
- [ ] 投资决策辅助

### Phase 4: 优化与部署
- [ ] 性能优化
- [ ] Docker化部署
- [ ] 阿里云部署准备